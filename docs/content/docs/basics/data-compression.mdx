---
title: "Data Compression"
description: "How to use RakNet's automatic data compression and decompression based on frequency tables from sample game sessions."
---

RakNet can automatically compress all your outgoing data and decompress your incoming data. To do this, it needs a "sample" frequency table for your average game so it can pre-compute how to encode the data to get maximum savings. Here is the general process:

<Steps>

<Step>

### Run a sample game

Run a sample "average" game. Get the frequency table for the server and for one of the clients (or average all the clients if you want).

</Step>

<Step>

### Generate server layers

Generate the decompression layer for the server from the client's frequency table. Generate the compression layer for the server from the server's frequency table.

</Step>

<Step>

### Generate client layers

Generate the decompression layer for the client from the server's frequency table. Generate the compression layer for the client from the client's frequency table.

</Step>

</Steps>

After that everything is handled automatically.

See `Samples\Compression` for a full example.

## Data Compression Functions

### SetCompileFrequencyTable

```cpp
SetCompileFrequencyTable(bool doCompile)
```

Enables or disables frequency table tracking. This is required to get a frequency table, which is used in `GenerateCompressionLayer()`. This value persists between connect calls and defaults to false (no frequency tracking). You can call this at any time; however, call it only when disconnected. Otherwise you only track part of the values sent over the network.

### GenerateCompressionLayer

```cpp
GenerateCompressionLayer(unsigned long inputFrequencyTable[256], bool inputLayer)
```

Generates the compression layer based on the input frequency table, which you obtain with `GetOutgoingFrequencyTable`. Call this twice: once with `inputLayer` as `true` and once as `false`. The frequency table passed here with `inputLayer=true` must match the frequency table on the recipient with `inputLayer=false`, and vice versa. Calling this function when there is an existing layer overwrites the old layer.

### DeleteCompressionLayer

```cpp
DeleteCompressionLayer(bool inputLayer)
```

Deletes the output or input layer as specified. This is not necessary to call and is only useful for freeing memory. Call this only when disconnected.

### GetOutgoingFrequencyTable

```cpp
GetOutgoingFrequencyTable(unsigned long outputFrequencyTable[256])
```

Returns the frequency of outgoing bytes into the output frequency table. The purpose is to save to file as a master frequency table from a sample game session for passing to `GenerateCompressionLayer()`. Call this only when disconnected. Requires that you first enable data frequency tracking by calling `SetCompileFrequencyTable(true)`.

### GetCompressionRatio

```cpp
float GetCompressionRatio()
```

Returns a number `n > 0.0f` where lower numbers are better. `n == 1.0f` means your data is no smaller or greater than the original. This shows how effective your compression rates are.

### GetDecompressionRatio

```cpp
float GetDecompressionRatio()
```

Returns a number `n > 0.0f` where higher numbers are better. `n == 1.0f` means the incoming data was decompressed to the same size as the compressed payload. This shows how effective your compression rates are.
