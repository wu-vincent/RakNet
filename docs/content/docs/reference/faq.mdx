---
title: "FAQ"
description: "Frequently asked questions about RakNet covering common issues with connections, data transfer, compilation errors, and configuration."
---

<Accordions>
<Accordion title="Sending strings">
Use the `StringCompressor` or `RakString` class to send strings through `BitStream`s.
</Accordion>

<Accordion title="Simulating lag">
For a quick test, use `RakPeer::ApplyNetworkSimulator`. For more thorough testing, use netlimiter.com, Network Emulator Toolkit (NEWT), or the network emulation built into Visual Studio 2010+.
</Accordion>

<Accordion title="Detecting bandwidth saturation">
```cpp
// Returns true if RakNet's output queue is increasing over time
bool PushingPastCapacity(RakNet::RakPeerInterface *rakPeer,
                         RakNet::Time currentTime,
                         SystemAddress remoteSystem) {
    static double bufferedBytesLastTick = 0.0;
    static RakNet::Time whenStartedPushingPastCapacity = currentTime;
    RakNetStatistics rns;
    rakPeer->GetStatistics(remoteSystem, &rns);
    double bufferedBytesThisTick =
        rns.bytesInSendBuffer[IMMEDIATE_PRIORITY] + rns.bytesInSendBuffer[HIGH_PRIORITY] +
        rns.bytesInSendBuffer[MEDIUM_PRIORITY] + rns.bytesInSendBuffer[LOW_PRIORITY];
    if (bufferedBytesThisTick > bufferedBytesLastTick) {
        if (currentTime - whenStartedPushingPastCapacity > 500) {
            bufferedBytesLastTick = bufferedBytesThisTick;
            return true;
        }
    } else {
        whenStartedPushingPastCapacity = currentTime;
    }
    bufferedBytesLastTick = bufferedBytesThisTick;
    return false;
}
```
</Accordion>

<Accordion title="Bitstream data corrupted on the remote side">
Cast `ID_*` enumerations to `(unsigned char)` when writing. Do not use types that differ between 64-bit and 32-bit systems, such as `int` or `long` (see `NativeTypes.h`). Ensure your read and write calls match.
</Accordion>

<Accordion title="Pointer data not arriving">
This is the same problem as using a default copy constructor with allocated memory. Sending a pointer transmits the pointer value, not the data it points to. Serialize the contents of pointers explicitly.
</Accordion>

<Accordion title="Dealing with firewalls">
Instruct end-users to open the appropriate ports, or use a port that is likely already open (such as HTTP). To reduce support calls, have the application attempt a local client-to-server connection on startup. If the connection fails after a few attempts, the user likely has a firewall blocking that port. Display an in-game message advising them to allow traffic on the relevant port.
</Accordion>

<Accordion title="Winsock macro or struct redefinition errors (e.g., 'AF_IPX', 'sockaddr')">
This is a bug in `winsock.h`. Include `winsock2.h` before `winsock.h`. Alternatively, include `WindowsIncludes.h` before `winsock.h`.
</Accordion>

<Accordion title="Conflicting lib errors (e.g., 'LIBCMT.lib already defined in LIBCD.lib')">
Select Multithreaded Debug and Multithreaded libraries in the project options.
</Accordion>

<Accordion title="Linker errors (e.g., 'LIBCMTD.lib already defined in MSVCRTD.lib')">
Right-click the project name, open Properties, navigate to Configuration Properties / C/C++ / Code Generation, and change from Multithreaded Debug DLL to Multithreaded Debug (same for release).
</Accordion>

<Accordion title="Dropped connections not detected or unable to reconnect">
By default, the timeout is 30 seconds in debug builds and 10 seconds in release builds. A lost-connection detection message is sent every 5 seconds, so reconnection may require waiting up to 35 seconds. Change the timeout with `RakPeerInterface::SetTimeoutTime`.
</Accordion>

<Accordion title="Event callbacks on packet arrival">
RakNet does not provide event callbacks on packet arrival. Poll `Receive` and trigger your own event when a non-null result is returned.
</Accordion>

<Accordion title="Common reasons connections fail">
-   The other system is not running RakNet.
-   The other system did not start the connection, or the startup function returned `false`.
-   The server has a firewall blocking incoming connections.
-   The server has a firewall blocking UDP data on the specified server port or the server port + 1 (for winsock 2.0+).
-   The client has a firewall blocking UDP data on the specified client port or the server port + 1 (for winsock 2.0+).
-   The server already has the maximum number of connected clients.
-   The server has a lot of network traffic and is too busy to respond to your connection request.
-   You used a different value for `connectionValidationInteger` than the other system.
-   You are connecting to the wrong port on the server.
-   You entered the wrong IP address of the server. This could be by mistyping or confusing the LAN address with the internet address.
-   One or both systems are not using high priority threads and are at the same time using a lot of CPU power for other threads. This could cause the network threads to not respond to the handshaking sequence fast enough.
-   The handshaking packets were lost due to normal packetloss
-   The connection succeeded, but the application never handled the connection-notification packets, either because no messages are being processed or because those specific messages are not handled.
-   The recipient is behind a NAT and did not use NAT punch-through.
</Accordion>

<Accordion title="Winsock linker redefinition errors (e.g., 'WSAData', 'SO_DONTLINGER')">
Add this to your preprocessor definitions:
`_WINSOCKAPI_`

In .NET this is under project / configuration properties / C/C++ / Preprocessor / Preprocessor definitions.
You will get this or a similar warning:

```text
warning C4005: '_WINSOCKAPI_' : macro redefinition unknown(0) : see previous definition of '_WINSOCKAPI_'
```

You can ignore it.
</Accordion>

<Accordion title="Connected but not receiving data">
- `Receive` is not being called.
- The other system did not send any data, or did not send data to you.
- The other system kicked you immediately after connection (e.g., banned or wrong password).
- The network disconnected you due to cheating detection or failure to deliver a reliable packet.
</Accordion>

<Accordion title="Networked actions happening twice (e.g., duplicate bullets)">
The server is broadcasting to everyone, including the client that initiated the action. To fix this, pass the `systemAddress` from the packet to the `systemAddress` field of `RakPeerInterface::Send` when broadcasting. This relays the message to all players except the sender.
</Accordion>

<Accordion title="Packet feedback loop (flooded with duplicate packets)">
This is a feedback loop, caused by the following sort of coding:

```cpp
// Client
void DoMyFunctionA(void) {
    SendPacketToDoFunctionA();
}

// Server
void HandlePacketToDoFunctionA(void) {
    // Broadcast to all connected players
    SendToAllPacketToDoFunctionA();
}

// Client
void ReceivePacketToDoFunctionA(void) {
    DoMyFunctionA();
}
```

To fix this, either separate the action from the send, or add a parameter specifying whether to send a packet and set it to `false` when the function is called from network code. See Programming Tips for further guidance.
</Accordion>

<Accordion title="Creating a master game browser">
The masterserver2.raknet.com service is defunct. You could use `CloudServer`, `PHPDirectoryServer2`, `RoomsPlugin`, `SteamLobby`, or `SQLite3Plugin`.
</Accordion>

<Accordion title="Multithreaded library version used by RakNet">
Multithreaded (/MT)
</Accordion>

<Accordion title="Whether your program needs the multithreaded library">
Not if you use the DLL -- the threads are confined to the DLL. If you use the static lib or source, then yes.
</Accordion>

<Accordion title="Running multiple client or server instances on one system">
Yes, but each instance has its own thread and memory. Assign a different port to each instance. In most cases this is unnecessary, since `RakPeer` handles multiple outgoing connections natively.
</Accordion>

<Accordion title="Sending files">
Send the file as a data stream using `RELIABLE`.
</Accordion>

<Accordion title="Using one license for multiple games">
A site license covers multiple games. A normal license requires one copy per game. Refer to the License Agreement for full details.
</Accordion>

<Accordion title="Using RakNet in non-game applications">
Yes.
</Accordion>

<Accordion title="Reducing lag">
- Use bandwidth more efficiently (see the optimization section in Programming Tips)
- Design the game to require less bandwidth (see the optimization section in Programming Tips)
- Use high priority threads
- Get a faster computer. This will make threads more responsive.
- Get a better internet connection.
- Decrease the number of clients allowed.
</Accordion>

<Accordion title="TCP usage in RakNet">
`RakPeer` does not. However, some plugins support it - `EmailSender`, `Autopatcher`, `FileListTransfer`, `DeltaDirectoryTransfer`.
</Accordion>

<Accordion title="C language compatibility">
No.
</Accordion>

<Accordion title="Windows 7 single outgoing connection limitation">
This was a design flaw in the initial Windows 7 release. Running Windows Update resolves the issue.
</Accordion>

<Accordion title="Cloud hosting support">
[Yes](/basics/cloud-hosting), RakNet works with Rackspace Cloud.
</Accordion>
</Accordions>
