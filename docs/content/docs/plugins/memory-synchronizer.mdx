---
title: "Memory Synchronizer"
description: "Scan memory for changes and automatically serialize and send updates to specified systems using the MemorySynchronizer plugin."
---

<Callout type="warn">
**Deprecated:** This system has been superseded by [ReplicaManager3](/plugins/replica-manager3), which provides more flexible object replication.
</Callout>

The memory synchronizer is an implementation of the [plugin interface](/plugins/plugin-interface) that scans memory for changes, serializes the changes, and sends them to specified systems. This is a more advanced implementation than the [DistributedNetworkObject](/plugins/distributed-network-object) class.

- Can work with any topology, not just client/server.
- Can specify target systems globally or per-data element, with per-system synchronization.
- Strings identify common pointers, rather than relying on the user to provide enumerations.
- Can use all send parameters to send updates.
- Can include timestamps with updates.

## Adding and removing participants

Adding and removing participants is optional. Passing `UNASSIGNED_PLAYER_ID` to either means all connected systems. Synchronizations will only be sent to and accepted by systems that are in the participant list. These functions are valid to call at any time.

```cpp
void AddParticipant(PlayerID playerId);
void RemoveParticipant(PlayerID playerId);
```

## SynchronizeMemory

`SynchronizeMemory` associates the pointer `memory` of size `memorySize` (in bytes) with a string identifier, or a class that implements `MemSynchSpec` (see below). Pass `0` for either `memory` or `memorySpec`, since only one of these parameters is allowed. `stringId` must be a unique identifier for this memory block. If you have instantiated objects, you either need to devise a scheme to provide a unique ID for each instance, or derive from `NetworkIDGenerator` and pass the value to `optionalInstanceID`.

`priority`, `reliability`, and `orderingChannel` are equivalent to the parameters in the RakNet send call. `sendUpdates` and `receiveUpdates` specify whether the local system scans for and sends updates to other systems and whether it accepts updates from other systems. Generally one system sends updates and all other systems receive updates for a particular memory block.

```cpp
void SynchronizeMemory(const char *stringId,
                       int maxUpdateFrequencyMS,
                       PacketPriority priority,
                       PacketReliability reliability,
                       char orderingChannel,
                       void *memory,
                       int memorySize,
                       MemSynchSpec *memorySpec,
                       bool sendUpdates,
                       bool receiveUpdates,
                       ObjectID optionalInstanceId = UNASSIGNED_OBJECT_ID);
```

```cpp
void UnsynchronizeMemory(void *memory, MemSynchSpec *memorySpec);
```

## MemSynchSpec class

The class interface `MemSynchSpec` provides the user with greater control over how and when memory elements are synchronized. To use it, pass a pointer to an implementation of `MemSynchSpec` to `SynchronizeMemory`.

| Virtual function | Description |
|---|---|
| `Serialize(BitStream*, MemSynchSpec* lastSentValue, unsigned long lastSendTime)` | Serialize your networked data elements into the provided BitStream. |
| `Deserialize(BitStream*, unsigned int timePacketSent)` | Deserialize the data you serialized. `timePacketSent` is valid if `IncludeTimestamp()` returns true. |
| `MakeSynchronizedDataCopy()` | Allocate a copy of the class and return the pointer. |
| `CopySynchronizedDataFrom(MemSynchSpec* source)` | Overwrite your data with the values held by the pointer. |
| `Release()` | RakNet no longer needs this copy. You can call `delete this;`. |
| `ShouldSendUpdate(PlayerID dest, MemSynchSpec* lastSentValue, unsigned long lastSendTime)` | Return whether the data should be sent to a given player. |
| `IsUnifiedMemory()` | Return `true` if the same value is sent to all systems (e.g. game score). Return `false` for contextual data (e.g. position updates). |
| `IncludeTimestamp()` | Return `true` if you want a valid time value sent to `Deserialize`. Only enable if needed, as bandwidth will be wasted otherwise. |

For a usage example, see the sample `Samples\Code Samples\MemorySynchronization`.

## See Also

- [Distributed Network Object](/plugins/distributed-network-object)
- [PluginInterface](/plugins/plugin-interface)
- [Fully Connected Mesh](/plugins/fully-connected-mesh)
